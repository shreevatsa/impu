<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Codemirror test</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/codemirror.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/codemirror.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/mode/markdown/markdown.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/mode/xml/xml.min.js"></script>

    <!-- Turned off folding because of scope for confusion by novices (where did my text go??) -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/addon/fold/foldgutter.min.css"> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/addon/fold/brace-fold.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/addon/fold/xml-fold.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/addon/fold/indent-fold.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/addon/fold/foldcode.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/addon/fold/foldgutter.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/addon/fold/markdown-fold.min.js"></script> -->

    <!-- Turned off autocomplete because it doesn't seem to work great with Indic text. -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/addon/hint/show-hint.min.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/addon/hint/anyword-hint.min.js"></script> -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.27.4/addon/hint/show-hint.min.css"> -->
    <style type="text/css">
      .CodeMirror {border: 1px solid silver; border-width: 1px 2px; }
      .cm-header { font-family: arial; }
      .cm-header-1 { font-size: 150%; }
      .cm-header-2 { font-size: 130%; }
      .cm-header-3 { font-size: 120%; }
      .cm-header-4 { font-size: 110%; }
      .cm-header-5 { font-size: 100%; }
      .cm-header-6 { font-size: 90%; }
      .cm-strong { font-size: 103%; }

      #container {
        display: flex;
        flex-direction: column;
        position: absolute;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
      }
      .CodeMirror {
          flex: 1 30em;
      }

      .CodeMirror pre {
          padding-bottom: 1.4em; /* More space between lines, but not between wrapped lines. */
      }

      /* .CodeMirror-lines { */
      /*     padding: 2em 0 2em; /\* Vertical padding around content *\/ */
      /* } */
      /* .CodeMirror */
      /* { */
      /*     line-height:50px; */ /* Increases the stuff even for wrapped lines */
      /* } */
    </style>
  </head>

  <body>
    <div id="container">
      <p>Type some text here.</p>
      <div id="forcm"></div>
      <p>See above</p>
    </div>
    <script id="script">
      var editor = CodeMirror(
          function(elt) {
              document.getElementById('container').replaceChild(elt, document.getElementById('forcm'));
          },
          {
              lineNumbers: true,
              lineWrapping: true,
              showCursorWhenSelecting: true,
              lineWiseCopyCut: false, // I don't understand this, but it sounds dangerous
              singleCursorHeightPerLine: false,
              autofocus: true,
              allowDropFileTypes: [],
              cursorScrollMargin: 1,
              // foldGutter: true,
              // gutters: ["CodeMirror-linenumbers", "CodeMirror-foldgutter"],
              mode: "markdown",
              value: `# A First Level Header

**Bold** text in a normal-size paragraph.

And a very long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long long, wrapped line with a piece of **big** text inside of it.

## A Second Level Header

Now is the time for all good men to come to
the aid of their country. This is just a
regular paragraph.

The quick brown fox jumped over the lazy
dog's back.

### Header 3

> This is a blockquote.
>
> This is the second paragraph in the blockquote.
>
> ## This is an H2 in a blockquote
      `,
          });

      // // Turned off autocomplete because it doesn't seem to work very well with Indic text
      // // From https://stackoverflow.com/questions/13744176/codemirror-autocomplete-after-any-keyup
      // editor.on("keyup", function (cm, event) {
      //     if (!cm.state.completionActive && /*Enables keyboard navigation in autocomplete list*/
      //         event.keyCode != 13) {        /*Enter - do not open autocomplete list just after item has been selected in it*/
      //         cm.showHint({completeSingle: false});
      //     }
      // });

    </script>
  </body>
</html>
